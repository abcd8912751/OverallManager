Index: app/src/main/java/com/furja/utils/TextInputListener.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.furja.utils;\r\n\r\n/**\r\n * 输入框 输入完成监听\r\n */\r\nimport android.view.KeyEvent;\r\nimport android.view.View;\r\nimport android.view.inputmethod.EditorInfo;\r\nimport android.widget.EditText;\r\nimport android.widget.TextView;\r\nimport com.furja.utils.SharpBus;\r\nimport com.furja.utils.Utils;\r\nimport java.util.regex.Pattern;\r\nimport static com.furja.utils.Constants.TAG_SCAN_BARCODE;\r\nimport static com.furja.utils.Utils.showLog;\r\nimport static com.furja.utils.Utils.showToast;\r\n\r\n/**\r\n * 输入框输入完成的监听,当输入完成调用其中方法\r\n */\r\npublic class TextInputListener implements View.OnKeyListener,EditText.OnEditorActionListener {\r\n    private long lastTimeMillis;\r\n    SharpBus sharpBus;\r\n    public static String INPUT_ERROR=\"条码格式错误\";\r\n    public TextInputListener() {\r\n        sharpBus = SharpBus.getInstance();\r\n    }\r\n    @Override\r\n    public boolean onKey(View view, int i, KeyEvent keyEvent) {\r\n        if (keyEvent.getKeyCode() == KeyEvent.KEYCODE_ENTER) {\r\n            TextView textView = (TextView) view;\r\n            excuteInput(textView.getText()+\"\");\r\n        }\r\n        return false;\r\n    }\r\n    @Override\r\n    public boolean onEditorAction(TextView textView, int i, KeyEvent keyEvent) {\r\n        if (i == EditorInfo.IME_ACTION_DONE)\r\n            excuteInput(textView.getText()+\"\");\r\n        return false;\r\n    }\r\n\r\n    public static void bind(EditText editText){\r\n        TextInputListener listener = new TextInputListener();\r\n        if(editText!=null){\r\n            editText.addTextChangedListener(TextChanger.flat(text->{\r\n                if(text.endsWith(\"\\n\"))\r\n                    listener.excuteInput(text);\r\n            }));\r\n            editText.setOnKeyListener(listener);\r\n            editText.setOnEditorActionListener(listener);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 处理输入的字符\r\n     * @param input\r\n     */\r\n    private void excuteInput(String input) {\r\n        input = getPureString(input);\r\n        if(input.isEmpty())\r\n            return;\r\n        String pattern=\"^[0-9]+[A-Z]+$\";\r\n        input = Utils.formatBarCode(input);\r\n        sharpBus.post(TAG_SCAN_BARCODE,input);\r\n    }\r\n\r\n    /**\r\n     * 获取去除 回车/换行符的字符串\r\n     * @param input\r\n     * @return\r\n     */\r\n    private String getPureString(String input) {\r\n        input=input.toUpperCase();\r\n        input = input.replace(\"\\n\", \"\");\r\n        input = input.replace(\"\\r\", \"\");\r\n        return input;\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/furja/utils/TextInputListener.java	(date 1577020050000)
+++ app/src/main/java/com/furja/utils/TextInputListener.java	(date 1577020306761)
@@ -49,6 +49,7 @@
             }));
             editText.setOnKeyListener(listener);
             editText.setOnEditorActionListener(listener);
+            showLog("测试");
         }
     }
 
